<!DOCTYPE html>
<html>

<head>
    <title>NGD-Vis</title>
    <script src="https://distill.pub/template.v1.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="main.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <meta charset="UTF-8">
</head>

<body>
    <dt-article>
        <h1>Curvature Corrected Learning</h1>
        <h2>Moving beyond gradient descent</h2>
        <dt-byline></dt-byline>

        <p>
            Much of Deep Learning can be summed up in one word: <b>Backpropagation</b>. New practitioners to the field
            will also be familiar with the phrases "gradient descent" or "momentum" or even "ADAM".
            Give the model an objective and a way to calculate how far it is from that objective (loss), and pass that
            information back into all of its parameters. Then update the parameters to make them produce a result that
            is closer to the objective.
            This process is called optimization. We will now explore if there is a practical way to train neural
            networks on gradients higher than first derivatives.
        </p>

        <h3>Motivation</h3>

        <p>
            Calculation of Higher Order Derivatives have the ability to create smoother descents into local/global
            optima without requiring momentum.
            Consider the following quadratic loss functions:
        </p>

        <div id="vis-quad">
            <div id="quad-plot"></div>

        </div>

        <h2> Debug Chain Net </h2>

        <div id="visChain" class="row l-page">
            <div class="col-md-4">
                <div class="slide-container">
                    <p>
                       1/q: <span id=q-val></span>
                    </p>
                    <!-- <input type="range" min="0" max="2" value="0" class="slider" id="q-slider"> -->
                    <input type="range" min="0" max="10" value="0" class="slider" id="q-slider">

                    <p>
                        learning rate: <span id=eta-val></span>
                    </p>
                    <input type="range" min="1" max="1000" value="550" class="slider" id="eta-slider">

                </div>
                <div id="hess-input">
                    <select name="HessType" id="hess-type">
                        <option value="full">Full</option>
                        <option value="block">Block</option>
                    </select>
                </div>

                <div id="simple-net-container" style="margin-top:3em;"></div>
            </div>
            <div class="col-md-6">
                <div id="chart" class="img-fluid"></div>
            </div>
        </div>

        <h2>Parameters as Unit-ful</h2>

        <div id="vis0" class="row l-page">
            <div class="col-md-4">
                <div class="slide-container">
                    <p>
                        1/q: <span id=q-val></span>
                    </p>
                    <!-- <input type="range" min="0" max="2" value="0" class="slider" id="q-slider"> -->
                    <input type="range" min="0" max="10" value="0" class="slider" id="q-slider">

                    <p>
                        learning rate: <span id=eta-val></span>
                    </p>
                    <input type="range" min="1" max="1000" value="550" class="slider" id="eta-slider">

                </div>
                <div id="hess-input">
                    <select name="HessType" id="hess-type">
                        <option value="full">Full</option>
                        <option value="block">Block</option>
                    </select>
                </div>

                <div id="simple-net-container" style="margin-top:3em;"></div>
            </div>
            <div class="col-md-6">
                <div id="chart" class="img-fluid"></div>
            </div>
        </div>

        <h2>A Simple Two Layer Network</h2>

        <p>
            Take, for instance, a simple 2 layer network with a single weight in each layer, shown in figure SHOW. Call
            the weight of the first and second layer \(w_0\) and \(w_1\) respectively.
            A simple objective function could then be

            $$w_1 w_2 = 1$$

            Let us explore the optimization space of this simple network. In the visualization below, \(q=0\) indicates
            pure SGD, \(q=1\) pure Natural Gradient Descent (NGD), and any \(q\) in the middle modifying the amount of
            each technique we include.
        </p>

        <div id="vis1" class="row l-page">
            <div class="col-md-4">
                <div class="slide-container">
                    <p>
                        1/q: <span id=q-val></span>
                    </p>
                    <!-- <input type="range" min="0" max="2" value="0" class="slider" id="q-slider"> -->
                    <input type="range" min="0" max="10" value="0" class="slider" id="q-slider">

                    <p>
                        learning rate: <span id=eta-val></span>
                    </p>
                    <input type="range" min="1" max="1000" value="550" class="slider" id="eta-slider">

                </div>
                <div id="hess-input">
                    <select name="HessType" id="hess-type">
                        <option value="full">Full</option>
                        <option value="block">Block</option>
                    </select>
                </div>

                <div id="simple-net-container" style="margin-top:3em;"></div>
            </div>
            <div class="col-md-6">
                <div id="chart" class="img-fluid"></div>
            </div>
        </div>

        <p>
            Notice how \(q=0.5\) updates everywhere the exact same, no matter what the value is of the loss surface at
            that point.
        </p>


        <h2>Golf Hole Problem</h2>

        <div id="vis2" class="container l-page side">
            <div class="">

                <select name="landscape-select" class="landscape-select">
                    <option value="hole">Hole</option>
                    <option value="steps">Steps</option>
                    <option value="seagull">Seagull</option>
                    <option value="bowl">Bowl</option>
                    <option value="deep_net">DeepNet d=3</option>
                </select>

                <div class="">
                    <div id="chart" class="img-fluid"></div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-6" id="chart-losses"></div>
                <div class="col-sm-6" id="chart-xdist"></div>
            </div>
        </div>

        <p>
            So we see that SGD blows up when the gradient of the loss is incredibly steep, and Natural Gradient Descent
            (NGD) blows up when the gradient of the loss is very small. To emphasize this phenomena, we show simple 1D
            loss functions that include areas of steep and shallow gradient.
        </p>

        <p>
            Three balls try to descend to the minimum of the loss simultaneously, and their loss is plotted alongside
            the distance to optimal weight value beneath the graph. The darkness of the ball indicates their
            \(\frac{1}{q}\) value. The light gray is SGD, dark gray is NGD, and our method is just gray.
        </p>


        <h2>A 2D loss surface</h2>

        <p>
            Unfortunately, very few loss surfaces are as flat and predictably stable as the examples above. A more
            jagged loss surface can be found below:
        </p>

        <div id="vis-2d-loss" class="container l-page">
            <div class="row">
                <div class="col-md-3">
                    <p>
                        1/q: <span id=q-val></span>
                    </p>
                    <!-- <input type="range" min="0" max="2" value="0" class="slider" id="q-slider"> -->
                    <input type="range" min="0" max="10" value="0" class="slider" id="q-slider">

                    <p>
                        learning rate: <span id=eta-val></span>
                    </p>
                    <input type="range" min="1" max="1000" value="1" class="slider" id="eta-slider">

                </div>
                <div class="col-md-9">
                    <div id="loss-2d" class="img-fluid"></div>
                </div>
            </div>
            <div class="row">
                <div class="offset-md-2 col-md-4" id="chart-losses"></div>
                <div class="col-md-4" id="chart-xdist"></div>
            </div>
        </div>


        <h2>Playground</h2>

        <p>
            Feel free to adjust and tune different learning rates and \(q\) values below.
        </p>

        <div id="vis3" class="container l-page">
            <div class="row">
                <div class="col-md-3">
                    <p>
                        1/q: <span id=q-val></span>
                    </p>
                    <!-- <input type="range" min="0" max="2" value="0" class="slider" id="q-slider"> -->
                    <input type="range" min="0" max="10" value="0" class="slider" id="q-slider">

                    <p>
                        learning rate: <span id=eta-val></span>
                    </p>
                    <input type="range" min="1" max="1000" value="1" class="slider" id="eta-slider">

                    <p>
                        <select name="landscape-select" class="landscape-select">
                            <option value="hole">Hole</option>
                            <option value="steps">Steps</option>
                            <option value="seagull">Seagull</option>
                            <option value="bowl">Bowl</option>
                            <option value="deep_net">DeepNet d=3</option>
                        </select>
                    </p>

                </div>
                <div class="col-md-9">
                    <div id="chart" class="img-fluid"></div>
                </div>
            </div>
            <div class="row">
                <div class="offset-md-2 col-md-4" id="chart-losses"></div>
                <div class="col-md-4" id="chart-xdist"></div>
            </div>
        </div>

    </dt-article>

    <!-- <dt-appendix></dt-appendix> -->

    <script src="vendor.js"></script>
    <script src="main.js"></script>
</body>

</html>